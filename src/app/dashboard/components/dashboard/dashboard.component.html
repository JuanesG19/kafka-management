<div class="dashboard-container">
  <mat-grid-list cols="3" rowHeight="100px" gutterSize="16px" class="dashboard-grid">
    @for(count of counts; track count){<mat-grid-tile colspan="1" rowspan="1" class="count-tile">
      <a [routerLink]="count.link" class="panel" [style]="count.style">
        <div class="title">{{ count.title }}</div>
        <div class="value">{{ count.value }}</div>
      </a>
    </mat-grid-tile>}
  </mat-grid-list>

  <div style="height: 10px;"></div>

  <div class="metrics-panel-container">
    <mat-card class="metrics-panel" appearance="outlined">
      <mat-card-header>
        <div class="header-content">
          <mat-card-title class="metrics-title">Metrics Overview</mat-card-title>
          <button mat-flat-button (click)="getMetrics()" class="refresh-btn">
            <mat-icon>refresh</mat-icon> Refresh
          </button>
        </div>
      </mat-card-header>

      <mat-card-content class="metrics-cards">
        <mat-card class="metric-card"
          [ngClass]="getMetricClass('connection-creation-total', metrics?.['connection-creation-total'])"
          matTooltip="Total de conexiones creadas al broker">
          <div class="metric-name">Created Connections</div>
          <div class="metric-value">
            {{ metrics?.['connection-creation-total'] | number }}
          </div>
        </mat-card>

        <mat-card class="metric-card"
          [ngClass]="getMetricClass('connection-close-total', metrics?.['connection-close-total'])"
          matTooltip="Total de conexiones cerradas al broker">
          <div class="metric-name">Closed Connections</div>
          <div class="metric-value">
            {{ metrics?.['connection-close-total'] | number }}
          </div>
        </mat-card>

        <mat-card class="metric-card" [ngClass]="getMetricClass('request-total', metrics?.['request-total'])"
          matTooltip="Número total de requests recibidos">
          <div class="metric-name">Requests Total</div>
          <div class="metric-value">
            {{ metrics?.['request-total'] | number }}
          </div>
        </mat-card>

        <mat-card class="metric-card" [ngClass]="getMetricClass('network-io-total', metrics?.['network-io-total'])"
          matTooltip="Total de bytes enviados/recibidos en la red">
          <div class="metric-name">Network IO Total</div>
          <div class="metric-value">
            {{ metrics?.['network-io-total'] | number }}
          </div>
        </mat-card>

        <mat-card class="metric-card" [ngClass]="getMetricClass('io-wait-ratio', metrics?.['io-wait-ratio'])"
          matTooltip="Tiempo que el sistema estuvo esperando I/O">
          <div class="metric-name">IO Wait Ratio</div>
          <div class="metric-value">
            {{ metrics?.['io-wait-ratio'] | percent:'1.0-2' }}
          </div>
        </mat-card>

        <mat-card class="metric-card" [ngClass]="getMetricClass('request-rate', metrics?.['request-rate'])" matTooltip="Requests por segundo">
          <div class="metric-name">Request Rate</div>
          <div class="metric-value">{{ metrics?.['request-rate'] | number }}</div>
        </mat-card>

        <mat-card class="metric-card" [ngClass]="getMetricClass('select-total', metrics?.['select-total'])" matTooltip="Total de operaciones de selección (lecturas)">
          <div class="metric-name">Select Total</div>
          <div class="metric-value">{{ metrics?.['select-total'] || 0 }}</div>
        </mat-card>

        <mat-card class="metric-card" [ngClass]="getMetricClass('connection-count', metrics?.['connection-count'])" matTooltip="Número actual de conexiones abiertas">
          <div class="metric-name">Connection Count</div>
          <div class="metric-value">{{ metrics?.['connection-count'] || 0 }}</div>
        </mat-card>
 
        <mat-card class="metric-card" [ngClass]="getMetricClass('outgoing-byte-total', metrics?.['outgoing-byte-total'])" matTooltip="Bytes enviados desde el broker">
          <div class="metric-name">Outgoing Bytes</div>
          <div class="metric-value">{{ metrics?.['outgoing-byte-total'] || 0 }}</div>
        </mat-card>
      </mat-card-content>
    </mat-card>
  </div>

</div>